<tool id="MQoutputfilter" name="Input file Filtering and Parsing" version="0.1.0">
    <description>Filter a file by keyworks or values</description>
    <requirements>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        ##echo $options.np.number_of_proteins > $output1
        python /projet/galaxydev/galaxy/tools/proteore_uc1/filter2.py 
        -i "$input1" 
        -o "$output1"
        --trash_file "$trash_file"

        ## Protein IDs
        #if $options_keyword.pi.protein_IDs == "text"
            --protein_IDs "$options_keyword.pi.txt"
        #else if $options_keyword.pi.protein_IDs == "file"
            --protein_IDs_file "$options_keyword.pi.file"
        #end if

        ## Protein names
        #if $options_keyword.pn.protein_names == "text"
            --protein_names "$options_keyword.pn.txt"
        #else if $options_keyword.pn.protein_names == "file"
            --protein_names_file "$options_keyword.pn.file"
        #end if

        ## Gene names
        #if $options_keyword.gn.gene_names == "text"
            --gene_names "$options_keyword.gn.txt"
        #else if $options_keyword.gn.gene_names == "file"
            --gene_names_file "$options_keyword.gn.file"
        #end if

        #* FASTA headers
        #if $options_keyword.fh.fasta_headers == "text"
            --fasta_headers "$options_keyword.fh.txt"
        #else
            --fasta_headers_file "$options_keyword.fh.file"
        #end if*#
        
        ## Number of proteins
        #if $options_value.np.number_of_proteins != "None"
            --number_of_proteins
            #if $options_value.np.number_of_proteins == "Equal"
                $options_value.np.equal "="
            #else if $options_value.np.number_of_proteins == "Higher"
                $options_value.np.higher ">"
            #else if $options_value.np.number_of_proteins == "Equal or higher"
                $options_value.np.equal_higher ">="
            #else if $options_value.np.number_of_proteins == "Lower"
                $options_value.np.lower "<"
            #else
                $options_value.np.equal_lower "<="
            #end if
        #end if

        ## Peptides
        #if $options_value.pep.peptides != "None"
            --peptides
            #if $options_value.pep.peptides == "Equal"
                $options_value.pep.equal "="
            #else if $options_value.pep.peptides == "Higher"
                $options_value.pep.higher ">"
            #else if $options_value.pep.peptides == "Equal or higher"
                $options_value.pep.equal_higher ">="
            #else if $options_value.pep.peptides == "Lower"
                $options_value.pep.lower "<"
            #else
                $options_value.pep.equal_lower "<="
            #end if
        #end if

        ## Q-value
        #if $options_value.qval.q_value != "None"
            --q_value
            #if $options_value.qval.q_value == "Equal"
                $options_value.qval.equal "="
            #else if $options_value.qval.q_value == "Higher"
                $options_value.qval.higher ">"
            #else if $options_value.qval.q_value == "Equal or higher"
                $options_value.qval.equal_higher ">="
            #else if $options_value.qval.q_value == "Lower"
                $options_value.qval.lower "<"
            #else
                $options_value.qval.equal_lower "<="
            #end if
        #end if

        ## Score
        #if $options_value.score.score != "None"
            --score
            #if $options_value.score.score == "Equal"
                $options_value.score.equal "="
            #else if $options_value.score.score == "Higher"
                $options_value.score.higher ">"
            #else if $options_value.score.score == "Equal or higher"
                $options_value.score.equal_higher ">="
            #else if $options_value.score.score == "Lower"
                $options_value.score.lower "<"
            #else
                $options_value.score.equal_lower "<="
            #end if
        #end if

        ## Intensity
        #if $options_value.intensity.intensity != "None"
            --intensity
            #if $options_value.intensity.intensity == "Equal"
                $options_value.intensity.equal "="
            #else if $options_value.intensity.intensity == "Higher"
                $options_value.intensity.higher ">"
            #else if $options_value.intensity.intensity == "Equal or higher"
                $options_value.intensity.equal_higher ">="
            #else if $options_value.intensity.intensity == "Lower"
                $options_value.intensity.lower "<"
            #else
                $options_value.intensity.equal_lower "<="
            #end if
        #end if

        ## iBAQ/iBAQ ratio
        #if $options_value.iBAQ.iBAQ != "None"
            --iBAQ
            $options_value.iBAQ.iBAQcolumn
            #if $options_value.iBAQ.iBAQ == "Equal"
                $options_value.iBAQ.equal "="
            #else if $options_value.iBAQ.iBAQ == "Higher"
                $options_value.iBAQ.higher ">"
            #else if $options_value.iBAQ.iBAQ == "Equal or higher"
                $options_value.iBAQ.equal_higher ">="
            #else if $options_value.iBAQ.iBAQ == "Lower"
                $options_value.iBAQ.lower "<"
            #else
                $options_value.iBAQ.equal_lower "<="
            #end if
        #end if
        ##echo $options.protein_IDs | tr ":" ";" >> $output1
    ]]></command>
    <inputs>
        <param type="data" name="input1" format="txt" label="Input: MaxQuant output file" />
        <section name="options_keyword" title="Filter by keywords options" expanded="False">
            <conditional name="pi">
                <param argument="--protein_IDs" type="select" label="Enter Protein IDs or a file containing Protein IDs to be eliminated" optional="True" >
                    <option value="text">Enter protein IDs</option>
                    <option value="file">Choose a file</option>
                </param>
                <when value="text" >
                    <param name="txt" type="text" label="Enter protein IDs" />
                </when>
                <when value="file" >
                    <param name="file" type="data" format="txt,tab" label="Choose a file" />
                </when>
            </conditional>
            <conditional name="pn">
                <param argument="--protein_names" type="select" label="Enter Protein names or a file containing Protein names to be eliminated" optional="True" >
                    <option value="text">Enter protein names</option>
                    <option value="file">Choose a file</option>
                </param>
                <when value="text">
                    <param name="txt" type="text" label="Enter protein names" />
                </when>
                <when value="file" >
                    <param name="file" type="data" format="txt,tab" label="Choose a file" />
                </when>
            </conditional>
            <conditional name="gn">
                <param argument="--gene_names" type="select" label="Enter Gene names or a file containing gene names to be eliminated" optional="True" >
                    <option value="text">Enter gene names</option>
                    <option value="file">Choose a file</option>
                </param>
                <when value="text">
                    <param name="txt" type="text" label="Enter gene names" />
                </when>
                <when value="file" >
                    <param name="file" type="data" format="txt,tab" label="Choose a file" />
                </when>
            </conditional>
            <!--conditional name="fh">
                <param argument="-fasta_headers" type="select" label="Enter FASTA headers or a file containing FASTA headers to be eliminated" optional="True" >
                    <option value="text">Enter FASTA headers</option>
                    <option value="file">Choose a file</option>
                </param>
                <when value="text">
                    <param name="txt" type="text" label="Enter FASTA headers" />
                </when>
                <when value="file" >
                    <param name="file" type="data" format="txt,tab" label="Choose a file" />
                </when>
            </conditional-->
        </section>
        <section name="options_value" title="Filter by value options" expanded="False">
            <conditional name="np">
                <param argument="--number_of_proteins" type="select" label="Filter by number of proteins" optional="True" >
                    <option value="None">---</option>
                    <option value="Equal">=</option>
                    <option value="Higher">&gt;</option>
                    <option value="Equal or higher">&gt;=</option>
                    <option value="Lower">&lt;</option>
                    <option value="Equal or lower">&lt;=</option>
                </param>
                <when value="None" >
                </when>
                <when value="Equal" >
                    <param name="equal" type="integer" value="" label="Value" />
                </when>
                <when value="Higher" >
                    <param type="integer" name="higher" value="" label="Value" />
                </when>
                <when value="Equal or higher" >
                    <param type="integer" name="equal_higher" value="" label="Value" />
                </when>
                <when value="Lower" >
                    <param type="integer" name="lower" value="" label="Value" />
                </when>
                <when value="Equal or lower" >
                    <param type="integer" name="equal_lower" value="" label="Value" />
                </when>
            </conditional>
            <conditional name="pep">
                <param argument="--peptides" type="select" label="Filter by number of Peptides" >
                    <option value="None">---</option>
                    <option value="Equal">=</option>
                    <option value="Higher">&gt;</option>
                    <option value="Equal or higher">&gt;=</option>
                    <option value="Lower">&lt;</option>
                    <option value="Equal or lower">&lt;=</option>
                </param>
                <when value="None" >
                </when>
                <when value="Equal" >
                    <param name="equal" type="integer" value="" label="Value" />
                </when>
                <when value="Higher" >
                    <param type="integer" name="higher" value="" label="Value" />
                </when>
                <when value="Equal or higher" >
                    <param type="integer" name="equal_higher" value="" label="Value" />
                </when>
                <when value="Lower" >
                    <param type="integer" name="lower" value="" label="Value" />
                </when>
                <when value="Equal or lower" >
                    <param type="integer" name="equal_lower" value="" label="Value" />
                </when>
            </conditional>
            <conditional name="qval">
                <param argument="--q_value" type="select" label="Filter by Q-value" >
                    <option value="None">---</option>
                    <option value="Equal">=</option>
                    <option value="Higher">&gt;</option>
                    <option value="Equal or higher">&gt;=</option>
                    <option value="Lower">&lt;</option>
                    <option value="Equal or lower">&lt;=</option>
                </param>
                <when value="None" >
                </when>
                <when value="Equal" >
                    <param name="equal" type="float" value="" label="Value" />
                </when>
                <when value="Higher" >
                    <param type="float" name="higher" value="" label="Value" />
                </when>
                <when value="Equal or higher" >
                    <param type="float" name="equal_higher" value="" label="Value" />
                </when>
                <when value="Lower" >
                    <param type="float" name="lower" value="" label="Value" />
                </when>
                <when value="Equal or lower" >
                    <param type="float" name="equal_lower" value="" label="Value" />
                </when>
            </conditional>
            <conditional name="score">
                <param argument="--score" type="select" label="Filter by Score" >
                    <option value="None">---</option>
                    <option value="Equal">=</option>
                    <option value="Higher">&gt;</option>
                    <option value="Equal or higher">&gt;=</option>
                    <option value="Lower">&lt;</option>
                    <option value="Equal or lower">&lt;=</option>
                </param>
                <when value="None" >
                </when>
                <when value="Equal" >
                    <param name="equal" type="float" value="" label="Value" />
                </when>
                <when value="Higher" >
                    <param type="float" name="higher" value="" label="Value" />
                </when>
                <when value="Equal or higher" >
                    <param type="float" name="equal_higher" value="" label="Value" />
                </when>
                <when value="Lower" >
                    <param type="float" name="lower" value="" label="Value" />
                </when>
                <when value="Equal or lower" >
                    <param type="float" name="equal_lower" value="" label="Value" />
                </when>
            </conditional>
            <conditional name="intensity">
                <param argument="--intensity" type="select" label="Filter by Intensity value" >
                    <option value="None">---</option>
                    <option value="Equal">=</option>
                    <option value="Higher">&gt;</option>
                    <option value="Equal or higher">&gt;=</option>
                    <option value="Lower">&lt;</option>
                    <option value="Equal or lower">&lt;=</option>
                </param>
                <when value="None" >
                </when>
                <when value="Equal" >
                    <param name="equal" type="integer" value="" label="Value" />
                </when>
                <when value="Higher" >
                    <param type="integer" name="higher" value="" label="Value" />
                </when>
                <when value="Equal or higher" >
                    <param type="integer" name="equal_higher" value="" label="Value" />
                </when>
                <when value="Lower" >
                    <param type="integer" name="lower" value="" label="Value" />
                </when>
                <when value="Equal or lower" >
                    <param type="integer" name="equal_lower" value="" label="Value" />
                </when>
            </conditional>
            <conditional name="iBAQ">
                <param argument="--iBAQ" type="select" label="Filter by iBAQ/iBAQ ratio value" >
                    <option value="None">---</option>
                    <option value="Equal">=</option>
                    <option value="Higher">&gt;</option>
                    <option value="Equal or higher">&gt;=</option>
                    <option value="Lower">&lt;</option>
                    <option value="Equal or lower">&lt;=</option>
                </param>
                <when value="None" >
                </when>
                <when value="Equal" >
                    <param name="equal" type="float" value="" label="Value" />
                    <param name="iBAQcolumn" type="integer" value="" label="Please specify the column number of the considered iBAQ/iBAQ ratio in input file" />  
                </when>
                <when value="Higher" >
                    <param type="float" name="higher" value="" label="Value" />
                    <param name="iBAQcolumn" type="integer" value="" label="Please specify the column number of the considered iBAQ/iBAQ ratio in input file" />  
                </when>
                <when value="Equal or higher" >
                    <param type="float" name="equal_higher" value="" label="Value" />
                    <param name="iBAQcolumn" type="integer" value="" label="Please specify the column number of the considered iBAQ/iBAQ ratio in input file" />  
                </when>
                <when value="Lower" >
                    <param type="float" name="lower" value="" label="Value" />
                    <param name="iBAQcolumn" type="integer" value="" label="Please specify the column number of the considered iBAQ/iBAQ ratio in input file" />  
                </when>
                <when value="Equal or lower" >
                    <param type="float" name="equal_lower" value="" label="Value" />
                    <param name="iBAQcolumn" type="integer" value="" label="Please specify the column number of the considered iBAQ/iBAQ ratio in input file" />  
                </when>

            </conditional>
        </section>
    </inputs>
    <outputs>
        <data name="output1" format="txt" label="${tool.name} on ${input1.name}" />
        <data name="trash_file" format="txt" label="Removed proteins from input file" />
    </outputs>
    <tests>       
    </tests>
    <help><![CDATA[
This tool allows you to filter a file that contains different information of proteins (for example, the output of MaxQuant software).


1. Filter reverse proteins (false proteins)
	By executing the tool, the rows whose protein ID starts with "\REV__" will be removed from input file.

2. Filter the file by keywords or values. You can choose to use one or more options.
	* **Keywords:** For each options, you can fill in the field or upload a file which contains the keywords.

	**Keywords can be case-insensitive**

	If you choose to fill in the field, the keywords should be separated by ":", for example:

    		A8K2U0:Q5TA79:O43175

	In other case, you can choose a file in text format in which each lines is a keyword, for example:

    		A8K2U0
    		Q5TA79
    		O43175

	**The line that contains these keywords will be eliminated from input file.**

	* **Values:** For each options, you can choose between "=", ">", ">=", "<" and "<=", then enter the value to filter.

**Available options**
	* **By keywords:**

		--protein_IDs
                	Protein IDs to filter
		--protein_names
                	Protein names to filter
		--gene_names
                	Gene names to filter

	* **By values:**

		--peptides
                	Peptides to filter
		--iBAQ
                	iBAQ/iBAQ ratio value to filter
		--number_of_proteins
                	Number of proteins to filter
		--intensity
                	Intensity value to filter
		--q_value
                	Q-value to filter
		--score         Score value to filter

**Output**

The tool will produce 2 output files.

* A text file containing the filtered input file.

* A text file containing the rows that were removed from input file. 

    ]]></help>
    <citations>
    </citations>
</tool>
